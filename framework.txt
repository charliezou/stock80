一、规整模块接口
1、属性接口：
   analyze_result=analyze(pricedata、成交量data、大盘指标data、。。。）---dict
   属性1 = analyze_result.get（****）

2、预测接口：
   forest_result=forest(pricedata、成交量data、大盘指标data、。。。）---dict  
   预测结果 = forest_result.get(****) 


二、APP函数功能
1、获取数据功能
   类：StockDataMgr -> 下载、更新、读取cvs
   类：StockSymbol -> instrument的syboml,syboml的基本信息（名称、行业、市值、市盈率、股息收益率） 
   类：StockMetaDB -> 对元数据的保存：syboml、市场、instrument、更新日期

   - 获取代码和代码基础信息
      get_instrument_symbols("CSI300") -> list
      get_symbol_baseinfo("600519.ss", "cn") -> dict
   - 获取和更新数据（日、周）
      download_symbol("600519.ss","cn",start=start) -> True
      download_symbols([("600519.ss","cn"),(...)], start=start) -> 成功list, 失败List
      download_instrument_symbols("CSI300") -> 成功list, 失败List
      get_stock_data("600519.ss","cn", day/week) -> pd 
      get_stocks_data(["600519.ss","cn"], day/week) -> dict
      get_instrument_data("CSI300") -> dict 

2、辅助函数
  utils
   - 生成包咯线数据
    extract_envelope(pd) -> pd
   - 寻找包咯线峰谷
    find_peaks(pd) -> list: [(date1,P),(date2,V),(...)]
   - 归一化和还原
    normalization(pd) -> pd 
    unnormalization(pd) -> pd
   - 年化收益率
    annualized_returns(pd, years) -> list: [(year, return),]
   - 盈亏时长比
    growth_scores(pd, years, peaks=None) -> list: [(year, scores),]

3、预测函数
   -未来值预测
   - predict_dwt(runconfig:dict, symbols,  pd) -> pred_pd, dict
      runconfig: dtw_model, x_stamp, y_stamp, lookback, pred_len;支持包洛线；组合大盘曲线；
   - predict_kronos(runconfig:dict, symbols,  pd) -> pred_pd, dict
    - runconfig: kronos_model, x_stamp, y_stamp, lookback, pred_len；;支持包洛线
       
   - batch_predict_dtw(runconfig:dict, [(symbols, pd),]) -> dict (symbol:pd, dict)
   - batch_predict_kronos(runconfig:dict, [(symbols, pd),]) -> dict (symbol:pd, dict)

   -准确性评估
    - 给定数据，确认测试区间段，对测试区间段每一点进行模型预测，返回[(lookback1,pred1,true1),...]
    - 计算归一化后的RMSE、方向准确率；
    
4、大盘行情趋势预测
  - analysis_situation(runconfig:dict,market, "CSI300") -> result: dict
     -运行周期：（谷峰下行 -> 筑底期 ->波谷上行 -> 筑峰期）、V值（当前值与上一个峰值的距离）、置信度；
     -runconfig:model、x_stamp 
      base模式: 生成包咯线数据 -> 定位最近一个峰值点、V值 -> 确定运行周期 -> 根据dtw寻找相似历史数据 -> 计算置信度
      模式2: 未来值预测 -> 生成包咯线数据 -> 计算当前点运行周期、V值 -> 根据dtw寻找相似历史数据 -> 计算置信度
      模式3: 结合成交量、高开低走\低开高走值
  - 准确性评估
    - 给定数据，确认测试区间段，对测试区间段每一点进行模型预测，返回[(lookback1,pred_运行周期，pred_V1,true_运行周期),...]
    - 计算V1值准确率、周期准确率；       

5、股票行情趋势预测

6、TopN策略
  - 股票排序
    - 模型预测未来值；last、min、max、mean作为得分
    - AI返回

6、回测函数
  - 单股票回测
    backTest(symbol, pd,...)
      - 每隔N周预测：预测值下个N周的last值，下降卖出，上升买入；周模型或者天模型
      - 行情趋势预测：筑底期/波谷上行建仓；筑峰期/波谷下行减仓；一次性/逐步建仓减仓策略；周模型
      - 组合预测: 大盘行情 + 股票行情组合；
  
  - 股票池回测
      - 每隔N周预测：根据预测值，从股票池中选择TopN建仓；

4、预测模型（价格预测、成交量预测）
   - 历史近似曲线模型
     - 组合预测（组合大盘指数）
   - kronos模型
   - 峰谷预测

5、预测封装
   - 单代码预测
   - 批量预测
   - 批量中选优
   - 大盘行情预测
   - 股票行情预测 

6、回测功能
   - 单代码回测
   - N选Top回测

7、股票属性计算
   - 成长性
   - 稳定性

8、股票池生成
   
9、机会点检测
   - 优质新股
   - 起飞股


2、对比大盘
2、ui
 a、属性汇总模块（文字）
   --名称、上市日期、市值、市盈率
   --成长性
   --稳定性

   --股票温度：近期表现、当前处于什么周期；确定性


 b、大盘指数
   --市值、市盈率
   --成长性
   --稳定性

   --大盘温度，近期表现、当前处于什么周期（谷底>谷底上行>上行接近谷峰->谷峰>谷峰下行->接近谷底）；确定性（谷底和谷峰确定性底）

 c、自动选股模型
   --检验模型：属性指标->未来（半年/一年）表现最佳的股票；每个市场的top6；指定板块的top3
   --注意：当前好不等于未来好，要检验处于什么周期

 d、操作模型
   --选择N股（自动选股模型）
   --大盘温度
     --高：买入：N中选择其中之2；周期性换股。（1、预测模型；2、deepseek选股）
     --低：卖出
   --回测功能

 

	

 


    

